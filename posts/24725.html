<!DOCTYPE HTML><html lang="zh-CN"><head><meta charset="utf-8"><meta name="keywords" content="ReFlow: Flow Straight and Fast-Learning to Generate and Transfer Data with Rectified Flow, DaNing的博客"><meta name="description" content="DaNing的个人博客."><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1,user-scalable=no"><meta name="renderer" content="webkit|ie-stand|ie-comp"><meta name="mobile-web-app-capable" content="yes"><meta name="format-detection" content="telephone=no"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-status-bar-style" content="black-translucent"><title>ReFlow: Flow Straight and Fast-Learning to Generate and Transfer Data with Rectified Flow | DaNing的博客</title><link rel="icon" type="image/png" href="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/medias/favicon.png"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/awesome/css/all.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/materialize/materialize.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/aos/aos.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/animate/animate.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/lightGallery/css/lightgallery.min.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/css/matery.css"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/css/my.css"><script src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/jquery/jquery.min.js"></script><meta name="generator" content="Hexo 4.2.1"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css"><link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"><link rel="stylesheet" href="/css/prism-tomorrow.css" type="text/css">
<link rel="stylesheet" href="/css/prism-line-numbers.css" type="text/css"></head><body><header class="navbar-fixed"><nav id="headNav" class="bg-color nav-transparent"><div id="navContainer" class="nav-wrapper container"><div class="brand-logo"><a href="/" class="waves-effect waves-light"><img src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/medias/logo.png" class="logo-img" alt="LOGO"> <span class="logo-span">DaNing的博客</span></a></div><a href="#" data-target="mobile-nav" class="sidenav-trigger button-collapse"><i class="fas fa-bars"></i></a><ul class="right nav-menu"><li class="hide-on-med-and-down nav-item"><a href="/" class="waves-effect waves-light"><i class="fas fa-home" style="zoom:.6"></i> <span>首页</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fas fa-tags" style="zoom:.6"></i> <span>标签</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fas fa-bookmark" style="zoom:.6"></i> <span>分类</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/about" class="waves-effect waves-light"><i class="fas fa-user-circle" style="zoom:.6"></i> <span>关于</span></a></li><li class="hide-on-med-and-down nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fas fa-comments" style="zoom:.6"></i> <span>留言板</span></a></li><li class="hide-on-med-and-down nav-item"><a href="" class="waves-effect waves-light"><i class="fas fa-tools" style="zoom:.6"></i> <span>工具</span> <i class="fas fa-chevron-down" aria-hidden="true" style="zoom:.6"></i></a><ul class="sub-nav menus_item_child"><li><a href="/shortcut"><i class="fas fa-rocket" style="margin-top:-20px;zoom:.6"></i> <span>导航(待完善)</span></a></li><li><a href="/helpyoubaidu"><i class="fas fa-wheelchair" style="margin-top:-20px;zoom:.6"></i> <span>帮你百度</span></a></li></ul></li><li><a href="#searchModal" class="modal-trigger waves-effect waves-light"><i id="searchIcon" class="fas fa-search" title="搜索" style="zoom:.85"></i></a></li></ul><div id="mobile-nav" class="side-nav sidenav"><div class="mobile-head bg-color"><img src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/medias/logo.png" class="logo-img circle responsive-img"><div class="logo-name">DaNing的博客</div><div class="logo-desc">DaNing的个人博客.</div></div><ul class="menu-list mobile-menu-list"><li class="m-nav-item"><a href="/" class="waves-effect waves-light"><i class="fa-fw fas fa-home"></i> 首页</a></li><li class="m-nav-item"><a href="/tags" class="waves-effect waves-light"><i class="fa-fw fas fa-tags"></i> 标签</a></li><li class="m-nav-item"><a href="/categories" class="waves-effect waves-light"><i class="fa-fw fas fa-bookmark"></i> 分类</a></li><li class="m-nav-item"><a href="/about" class="waves-effect waves-light"><i class="fa-fw fas fa-user-circle"></i> 关于</a></li><li class="m-nav-item"><a href="/contact" class="waves-effect waves-light"><i class="fa-fw fas fa-comments"></i> 留言板</a></li><li class="m-nav-item"><a href="javascript:;"><i class="fa-fw fas fa-tools"></i> 工具 <span class="m-icon"><i class="fas fa-chevron-right"></i></span></a><ul><li><a href="/shortcut" style="margin-left:75px"><i class="fa fas fa-rocket" style="position:absolute;left:50px"></i> <span>导航(待完善)</span></a></li><li><a href="/helpyoubaidu" style="margin-left:75px"><i class="fa fas fa-wheelchair" style="position:absolute;left:50px"></i> <span>帮你百度</span></a></li></ul></li></ul></div></div></nav></header><script src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/cryptojs/crypto-js.min.js"></script><script></script><div class="bg-cover pd-header post-cover" style="background-image:url(https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/medias/featureimages/4.jpg)"><div class="container" style="right:0;left:0"><div class="row"><div class="col s12 m12 l12"><div class="brand"><h1 class="description center-align post-title">ReFlow: Flow Straight and Fast-Learning to Generate and Transfer Data with Rectified Flow</h1></div></div></div></div></div><main class="post-container content"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/tocbot/tocbot.css"><style>#articleContent h1::before,#articleContent h2::before,#articleContent h3::before,#articleContent h4::before,#articleContent h5::before,#articleContent h6::before{display:block;content:" ";height:100px;margin-top:-100px;visibility:hidden}#articleContent :focus{outline:0}.toc-fixed{position:fixed;top:64px}.toc-widget{width:345px;padding-left:20px}.toc-widget .toc-title{margin:35px 0 15px 0;padding-left:17px;font-size:1.5rem;font-weight:700;line-height:1.5rem}.toc-widget ol{padding:0;list-style:none}#toc-content{height:calc(100vh - 250px);overflow:auto}#toc-content ol{padding-left:10px}#toc-content ol li{padding-left:10px}#toc-content .toc-link:hover{color:#42b983;font-weight:700;text-decoration:underline}#toc-content .toc-link::before{background-color:transparent;max-height:25px;position:absolute;right:23.5vw;display:block}#toc-content .is-active-link{color:#42b983}#floating-toc-btn{position:fixed;right:15px;bottom:76px;padding-top:15px;margin-bottom:0;z-index:998}#floating-toc-btn .btn-floating{width:48px;height:48px}#floating-toc-btn .btn-floating i{line-height:48px;font-size:1.4rem}</style><div class="row"><div id="main-content" class="col s12 m12 l9"><div id="artDetail"><div class="card"><div class="card-content article-info"><div class="row tag-cate"><div class="col s7"><div class="article-tag"><a href="/tags/Diffusion/"><span class="chip bg-color">Diffusion</span> </a><a href="/tags/Flow/"><span class="chip bg-color">Flow</span> </a><a href="/tags/ReFlow/"><span class="chip bg-color">ReFlow</span></a></div></div><div class="col s5 right-align"><div class="post-cate"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" class="post-category">深度学习</a></div></div></div><div class="post-info"><div class="post-date info-break-policy"><i class="far fa-calendar-minus fa-fw"></i>发布日期:&nbsp;&nbsp; 2025-05-20</div><div class="post-date info-break-policy"><i class="far fa-calendar-check fa-fw"></i>更新日期:&nbsp;&nbsp; 2025-05-29</div><div class="info-break-policy"><i class="far fa-file-word fa-fw"></i>文章字数:&nbsp;&nbsp; 3k</div><div class="info-break-policy"><i class="far fa-clock fa-fw"></i>阅读时长:&nbsp;&nbsp; 12 分</div></div></div><hr class="clearfix"><div class="card-content article-card-content"><div id="articleContent"><h1 id="Flow-Straight-and-Fast-Learning-to-Generate-and-Transfer-Data-with-Rectified-Flow"><a href="#Flow-Straight-and-Fast-Learning-to-Generate-and-Transfer-Data-with-Rectified-Flow" class="headerlink" title="Flow Straight and Fast: Learning to Generate and Transfer Data with Rectified Flow"></a>Flow Straight and Fast: Learning to Generate and Transfer Data with Rectified Flow</h1><ul><li>论文: <a href="https://arxiv.org/abs/2209.03003" target="_blank" rel="noopener">Flow Straight and Fast: Learning to Generate and Transfer Data with Rectified Flow</a>, ICLR 2023.</li><li>代码: <a href="https://github.com/gnobitab/RectifiedFlow" target="_blank" rel="noopener">GitHub - gnobitab/RectifiedFlow: Official Implementation of Rectified Flow (ICLR2023 Spotlight)</a>.</li><li>知乎讲解(一作): <a href="https://zhuanlan.zhihu.com/p/603740431" target="_blank" rel="noopener">[ICLR2023] 扩散生成模型新方法：极度简化，一步生成 - XCLiu的文章 - 知乎</a>.</li></ul><h2 id="Rectified-Flow"><a href="#Rectified-Flow" class="headerlink" title="Rectified Flow"></a>Rectified Flow</h2><h3 id="Learning-Transport-Mapping"><a href="#Learning-Transport-Mapping" class="headerlink" title="Learning Transport Mapping"></a>Learning Transport Mapping</h3><p>对于很多的无监督任务, 都可以被<strong>统一</strong>为建模<strong>两个分布</strong>之间的<strong>运输过程</strong>:</p><ol><li>如GAN / VAE等生成类模型中建模的, 往往是建模一个简单的已知的分布到一个复杂的原始数据分布之间的关系.</li><li>所有的Domain Transfer Method, 例如Image-to-Image Translation, Style Transfer, Domain Adaption等任务, 都是在建模<strong>两个分布</strong>之间的<strong>转移关系</strong>.</li></ol><p>因此, 将上述任务统一建模两个分布之间的运输过程. 形式化定义如下.</p><p>对于观测到的两个分布$\pi_0, \pi_1 \in \mathbb{R}^d$ , 需要找到一个运输映射$T: \mathbb{R}^d \rightarrow \mathbb{R}^d$, 能够使得在数据接近无限的情况下, 当$Z_0 \sim \pi_0$时, 有$Z_1 :=T(Z_0) \sim \pi_1$.</p><p>Rectified Flow将$X_0$ 转换为$X_1$ 的过程建模为一个定义在时间$t \in [0, 1]$ 上的<a href="https://zh.wikipedia.org/wiki/%E5%B8%B8%E5%BE%AE%E5%88%86%E6%96%B9%E7%A8%8B" target="_blank" rel="noopener">常微分方程</a>(<strong>ODE</strong>):</p><p>$$<br>\mathrm{d} Z_t=v\left(Z_t, t\right) \mathrm{d} t<br>$$</p><p>该过程将$Z_0 \sim \pi_0$ 转换为$Z_1 \sim \pi_1$. 对于这个转换过程, $X_0$ 为起点, $X_1$ 为终点. 转换过程中对应的<strong>向量场</strong> $v: \mathbb{R}^d \rightarrow \mathbb{R}^d$ 被作者设置为使$X_0$ 遵循$X_1 - X_0$ 的方向<strong>尽可能沿直线移动</strong>的向量场.</p><blockquote><p>这个向量场$v$ 就像河流中的水流一样, 可以将任意$X_t$ 位置的小船随着河流推至目的地$X_1$.</p></blockquote><p>上述目标通过一个简单的<strong>MSE Loss</strong>来学习到:</p><p>$$<br>\min _v \int_0^1 \mathbb{E}\left[\left\Vert\left(X_1-X_0\right)-v\left(X_t, t\right)\right\Vert^2\right] \mathrm{d} t, \quad \text { with } \quad X_t=t X_1+(1-t) X_0<br>$$</p><p>其中$X_t$ 为$X_0, X_1$ 之间的<strong>线性插值,</strong> 它会遵循ODE $\mathrm{d}X_t = (X_1 - X_0) \mathrm{d}t$. 需要注意的是, 它是Non-Causal的, 即$X_t$ 需要依赖终点$X_1$ 才可得知, 但是$X_1$ 在推理时又是未知的. 不过它可以通过用$X_1 - X_0$ 训练向量场$v$, 可以在不知道$X_1$ 的情况下将$X_t$ 推至$X_1 - X_0$ 的插值路径上, 从而实现把这个过程变成Causal的.</p><p>在实际推理时, $X_0 \sim \pi_0$ 往往是咱们已知的简单分布, 进一步用欧拉法采样就可以得到需要的$X_1$ 了. 或者再更换一些其他的高阶采样方法也是可以的, 只不过会引入更多的计算量. 假设步长为$\frac{1}{N}$, 则有:</p><p>$$<br>\hat{Z}_{t+\frac{1}{N}} = \hat{Z}_t + v(\hat{Z}_t, t) \cdot \frac{1}{N}<br>$$</p><p>特别的, 对于一种特殊的单步情况, 有$z_1 = z_0 + v(z_0, 0)$.</p><p>对, 如果只谈方法的话就这么简单, Rectified Flow介绍完了. 本文到此结束(×).</p><h3 id="Flows-Avoid-Crossing"><a href="#Flows-Avoid-Crossing" class="headerlink" title="Flows Avoid Crossing"></a>Flows Avoid Crossing</h3><img src="https://cdn.jsdelivr.net/gh/ADAning/Image/MLDL/rectified flow1.png" style="zoom:50%"><p>Rectified Flow核心在于, 对于定义好的ODE $\mathrm{d} Z_t=v\left(Z_t, t\right) \mathrm{d} t$, 应该是<strong>解存在且唯一</strong>的, 且对于时间$t \in [0, 1)$ 在场内的两条轨迹都不能交叉. 即<strong>不存在</strong>位置$z \in \mathbb{R}^d$ 和时间$t \in [0, 1)$ 使得两条路径能在同一时刻$t$ 以不同方向穿过位置$z$, 如果出现了, 则ODE的解就不是唯一的了.</p><blockquote><p>换句话说, 在向量场$v$ 中, 对于任意初始点$(z_0, t_0)$, 存在轨迹$z(t)$, 该轨迹在任意时刻$t$ 的位置是<strong>确定</strong>且<strong>唯一</strong>的, 并且取决于初始信息$(z_0, t_0)$.</p></blockquote><p>对于$X_0 \sim \pi_0, X_1 \sim \pi_1$, 当对$X_1, X_0$ 进行<strong>线性插值</strong>时, 其插值$X_t$ 可能导致出现轨迹的交叉, 从而导致它的<strong>Non-Causal</strong>, 如上图 (a). 即依赖于未来的关系, 已知$(X_0, X_1)$ 的<strong>全局配对关系</strong>才能确定轨迹, 否则会出现 (a) 中的$X_0$ 与上面和下面的$X_1$ 匹配都可以的情况.</p><p>因此, Rectified Flow通过对ODE的建模, 利用ODE唯一解的性质, 来避免了这种交叉轨迹的情况, 如上图 (b). 可以将线性插值$X_t$ 视为是连接$\pi_0, \pi_1$ 之间的公路, 而Rectified Flow的学习到的向量场$v$ 在<strong>无需依赖未来信息</strong>的条件下迫使$X_0$ 的点按照向量场中<strong>确定路径</strong>移动到$X_1$, 从而得到一组确定的匹配关系$(Z_0, Z_1)$. 因此向量场$v$ 更像是在引导车辆沿哪条路走的交通拥堵情况. 并且$v$ 在学习的时候, 并不关心$(X_0, X_1)$ 全局上是如何配对的, <strong>它只关心局部角度学到的向量场是什么样的</strong>, 所以它是Causal的.</p><blockquote><p>在进行过一次Rectified Flow后, 得到的新的匹配对$(Z_0, Z_1)$ 已经是两两匹配的, 如图 (c), (d)所示. 该性质在下个小节会提到.</p></blockquote><h3 id="Straight-Line-Flows-Yield-Fast-Simulation"><a href="#Straight-Line-Flows-Yield-Fast-Simulation" class="headerlink" title="Straight Line Flows Yield Fast Simulation"></a>Straight Line Flows Yield Fast Simulation</h3><p>通过对上面的内容观察发现, 虽然定义了Rectified Flow, 但是它的向量场引导的粒子轨迹仍然不是一条直线.</p><p>再回顾下之前的Non-Causal. 如果知道了$X_0, X_1$ 之间的配对关系, 是不是就能通过一步采样, 让模型走直线, 直接通过$X_0$ 找到对应的$X_1$? 当时的问题在于, 它是Non-Causal的. 我们需要的是Causal的向量场, 所以这时的向量场$v$ 只能基于$X_0, X_1$ 之间构造的<strong>随机两两匹配对</strong>进行训练.</p><p>但是, 我们在进行过一次Rectified Flow后, $X_0, X_1$ 之间的配对关系在第一次的Rectified Flow作用下, 已经能够拿到<strong>有先验的匹配对</strong>了, 即每个$X_0$ 已经有了确定匹配的$X_1$ 作为目标! 有了基于1-ReFlow的新匹配对$(Z_0^1, Z_1^1)$, 再次进行Rectified Flow, $Z_0^1$ 会沿着更”直”的轨迹运动到$Z_1^1$! 所以作者提出了ReFlow.</p><p>如果$\boldsymbol{Z}=\operatorname{RectFlow}\left(\left(X_0, X_1\right)\right)$ 代表从$(X_0, X_1)$ 得到的Rectified Flow, 对每次ReFlow的结果可以进行<strong>叠叠乐</strong>, 递归调用得到:</p><p>$$<br>\boldsymbol{Z}^{k+1}=\operatorname{RectFlow}\left(\left(Z_0^k, Z_1^k\right)\right)<br>$$</p><p>其中$(Z_0^0, Z_1^0) = (X_0, X_1)$, $\boldsymbol{Z}^{k}$ 为第$k$ 个Rectified Flow.</p><p>多次ReFlow后的效果:</p><img src="https://cdn.jsdelivr.net/gh/ADAning/Image/MLDL/rectified flow2.png" style="zoom:50%"><p>这种ReFlow不但降低了Transport Cost, 还对ReFlow中的路径进行了”拉直”, 越多次的ReFlow, 粒子的轨迹就越”直”. 不负责任的说, 如果你想要4-ReFlow, 5-ReFlow… 甚至你可以一直ReFlow下去…</p><blockquote><p>我看论文的时候就感觉, 实际应用过程中$v$ 不可能学的非常理想, 所以每次获得的$Z_1^k$ 通常与希望得到的$X_1$ 是有偏差的, 这就导致ReFlow多次会产生<strong>误差累计</strong>, <a href="https://zhuanlan.zhihu.com/p/603740431" target="_blank" rel="noopener">这个问题作者本人也提到了</a>, 所以不建议进行过多的ReFlow堆叠.</p></blockquote><h3 id="Distillation"><a href="#Distillation" class="headerlink" title="Distillation"></a>Distillation</h3><p>经过$k$ 次Rectified Flow $\boldsymbol{Z}^{k}$ 后, 可以直接将多次ReFlow后得到的$(Z_0^k, Z_1^k)$ 的匹配关系蒸馏到NN $\hat{T}$ 中, 从而实现一步生成的$\hat{T}(z_0) \approx z_0 + v(z_0, 0)$.</p><p>在蒸馏的时候, 只需要将ReFlow的训练目标中的$t$ 设置为0, 即如下Loss来训练$\hat{T}$:</p><p>$$<br>\mathcal{L} = \mathbb{E}\left[\left\Vert\left(Z_1^k-Z_0^k\right)-v\left(Z_0^k, 0\right)\right\Vert^2\right]<br>$$</p><blockquote><p>但是注意, ReFlow和Distillation是完全不同的, 因为Distillation只学习$(Z_0^k, Z_1^k)$ 之间的映射关系(即$t=0, t=1$), 而ReFlow则在优化$Z_0^k \rightarrow Z_1^k$ 之间的整个过程(即$t \in [0, 1)$ 之间).</p></blockquote><p>综上, Rectified Flowd的算法流程伪代码如下:</p><img src="https://cdn.jsdelivr.net/gh/ADAning/Image/MLDL/rectified flow3.png" style="zoom:50%"><h2 id="Notebook-Tutorial"><a href="#Notebook-Tutorial" class="headerlink" title="Notebook Tutorial"></a>Notebook Tutorial</h2><p>由于作者提供了Notebook方便大家了解Rectified Flow的匹配过程, 所以咱们也瞅瞅Rectified Flow是怎么实现的, 超级简单(这也是为什么很多生成类模型想换Rectified Flow, 因为它工程上便于实现):</p><p><a href="https://colab.research.google.com/drive/1CyUP5xbA3pjH55HDWOA8vRgk2EEyEl_P?usp=sharing" target="_blank" rel="noopener"><img src="https://colab.research.google.com/assets/colab-badge.svg" alt="右键我在COLAB中打开!"></a></p><p>如果你不能科学上网, 应该看不到<code>Open in Colab</code>的图标.</p><p>如果想看作者在论文中的例子(就是两个类的例子), 可以将Notebook中第一个<code>codeblock</code>中的代码做如下改动(直接复制粘贴就行, 只更改了数据的初始化方式):</p><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">import</span> torch
<span class="token keyword">import</span> numpy <span class="token keyword">as</span> np
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn <span class="token keyword">as</span> nn
<span class="token keyword">from</span> torch<span class="token punctuation">.</span>distributions <span class="token keyword">import</span> Normal<span class="token punctuation">,</span> Categorical
<span class="token keyword">from</span> torch<span class="token punctuation">.</span>distributions<span class="token punctuation">.</span>multivariate_normal <span class="token keyword">import</span> MultivariateNormal
<span class="token keyword">from</span> torch<span class="token punctuation">.</span>distributions<span class="token punctuation">.</span>mixture_same_family <span class="token keyword">import</span> MixtureSameFamily
<span class="token keyword">import</span> matplotlib<span class="token punctuation">.</span>pyplot <span class="token keyword">as</span> plt
<span class="token keyword">import</span> torch<span class="token punctuation">.</span>nn<span class="token punctuation">.</span>functional <span class="token keyword">as</span> F


D <span class="token operator">=</span> <span class="token number">10</span><span class="token punctuation">.</span>
M <span class="token operator">=</span> D<span class="token operator">+</span><span class="token number">5</span>
VAR <span class="token operator">=</span> <span class="token number">0.3</span>
DOT_SIZE <span class="token operator">=</span> <span class="token number">4</span>
COMP <span class="token operator">=</span> <span class="token number">2</span>

initial_mix <span class="token operator">=</span> Categorical<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">/</span>COMP <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>COMP<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
initial_comp <span class="token operator">=</span> MultivariateNormal<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span><span class="token operator">-</span>D <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span>D <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token operator">-</span>D <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> D <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>float<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> VAR <span class="token operator">*</span> torch<span class="token punctuation">.</span>stack<span class="token punctuation">(</span><span class="token punctuation">[</span>torch<span class="token punctuation">.</span>eye<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>COMP<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
initial_model <span class="token operator">=</span> MixtureSameFamily<span class="token punctuation">(</span>initial_mix<span class="token punctuation">,</span> initial_comp<span class="token punctuation">)</span>
samples_0 <span class="token operator">=</span> initial_model<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10000</span><span class="token punctuation">]</span><span class="token punctuation">)</span>

target_mix <span class="token operator">=</span> Categorical<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">1</span><span class="token operator">/</span>COMP <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>COMP<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
target_comp <span class="token operator">=</span> MultivariateNormal<span class="token punctuation">(</span>torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token punctuation">[</span>D <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> <span class="token operator">-</span> D <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>D <span class="token operator">*</span> np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span><span class="token number">3</span><span class="token punctuation">)</span> <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">,</span> D <span class="token operator">/</span> <span class="token number">2</span><span class="token punctuation">.</span><span class="token punctuation">]</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">.</span>float<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> VAR <span class="token operator">*</span> torch<span class="token punctuation">.</span>stack<span class="token punctuation">(</span><span class="token punctuation">[</span>torch<span class="token punctuation">.</span>eye<span class="token punctuation">(</span><span class="token number">2</span><span class="token punctuation">)</span> <span class="token keyword">for</span> i <span class="token keyword">in</span> range<span class="token punctuation">(</span>COMP<span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
target_model <span class="token operator">=</span> MixtureSameFamily<span class="token punctuation">(</span>target_mix<span class="token punctuation">,</span> target_comp<span class="token punctuation">)</span>

samples_1 <span class="token operator">=</span> target_model<span class="token punctuation">.</span>sample<span class="token punctuation">(</span><span class="token punctuation">[</span><span class="token number">10000</span><span class="token punctuation">]</span><span class="token punctuation">)</span>
<span class="token keyword">print</span><span class="token punctuation">(</span><span class="token string">'Shape of the samples:'</span><span class="token punctuation">,</span> samples_0<span class="token punctuation">.</span>shape<span class="token punctuation">,</span> samples_1<span class="token punctuation">.</span>shape<span class="token punctuation">)</span>

plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">4</span><span class="token punctuation">,</span><span class="token number">4</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token operator">-</span>M<span class="token punctuation">,</span>M<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token operator">-</span>M<span class="token punctuation">,</span>M<span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>r<span class="token string">'Samples from $\pi_0$ and $\pi_1$'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>samples_0<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> samples_0<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> label<span class="token operator">=</span>r<span class="token string">'$\pi_0$'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>scatter<span class="token punctuation">(</span>samples_1<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> samples_1<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>cpu<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> alpha<span class="token operator">=</span><span class="token number">0.1</span><span class="token punctuation">,</span> label<span class="token operator">=</span>r<span class="token string">'$\pi_1$'</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>legend<span class="token punctuation">(</span><span class="token punctuation">)</span>
plt<span class="token punctuation">.</span>tight_layout<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>如果对学习到的ODE(向量场)长什么样感到好奇, 可以用如下代码可以做出向量场:</p><blockquote><p>The following code is supported by <a href="https://chat.deepseek.com" target="_blank" rel="noopener">DeepSeek</a>.</p></blockquote><pre class="line-numbers language-python"><code class="language-python"><span class="token keyword">def</span> <span class="token function">plot_vector_field</span><span class="token punctuation">(</span>rectified_flow<span class="token punctuation">,</span> t<span class="token operator">=</span><span class="token number">0.0</span><span class="token punctuation">,</span> n_grid<span class="token operator">=</span><span class="token number">30</span><span class="token punctuation">)</span><span class="token punctuation">:</span>

    <span class="token triple-quoted-string string">"""绘制指定时间t的二维向量场"""</span>

    <span class="token comment" spellcheck="true"># 生成网格点</span>
    x <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> n_grid<span class="token punctuation">)</span>
    y <span class="token operator">=</span> np<span class="token punctuation">.</span>linspace<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">,</span> n_grid<span class="token punctuation">)</span>
    X<span class="token punctuation">,</span> Y <span class="token operator">=</span> np<span class="token punctuation">.</span>meshgrid<span class="token punctuation">(</span>x<span class="token punctuation">,</span> y<span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># 转换为PyTorch张量</span>

    grid_points <span class="token operator">=</span> torch<span class="token punctuation">.</span>tensor<span class="token punctuation">(</span>np<span class="token punctuation">.</span>stack<span class="token punctuation">(</span><span class="token punctuation">[</span>X<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">,</span> Y<span class="token punctuation">.</span>ravel<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span><span class="token punctuation">,</span> axis<span class="token operator">=</span><span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">,</span> dtype<span class="token operator">=</span>torch<span class="token punctuation">.</span>float32<span class="token punctuation">)</span>
    time_points <span class="token operator">=</span> torch<span class="token punctuation">.</span>ones<span class="token punctuation">(</span><span class="token punctuation">(</span>grid_points<span class="token punctuation">.</span>shape<span class="token punctuation">[</span><span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">)</span><span class="token punctuation">)</span> <span class="token operator">*</span> t

    <span class="token comment" spellcheck="true"># 模型预测向量场</span>

    <span class="token keyword">with</span> torch<span class="token punctuation">.</span>no_grad<span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">:</span>
        vectors <span class="token operator">=</span> rectified_flow<span class="token punctuation">.</span>model<span class="token punctuation">(</span>grid_points<span class="token punctuation">,</span> time_points<span class="token punctuation">)</span><span class="token punctuation">.</span>numpy<span class="token punctuation">(</span><span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># 转换为绘图格式</span>
    U <span class="token operator">=</span> vectors<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">0</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>n_grid<span class="token punctuation">,</span> n_grid<span class="token punctuation">)</span>
    V <span class="token operator">=</span> vectors<span class="token punctuation">[</span><span class="token punctuation">:</span><span class="token punctuation">,</span> <span class="token number">1</span><span class="token punctuation">]</span><span class="token punctuation">.</span>reshape<span class="token punctuation">(</span>n_grid<span class="token punctuation">,</span> n_grid<span class="token punctuation">)</span>

    <span class="token comment" spellcheck="true"># 绘制向量场</span>

    plt<span class="token punctuation">.</span>figure<span class="token punctuation">(</span>figsize<span class="token operator">=</span><span class="token punctuation">(</span><span class="token number">8</span><span class="token punctuation">,</span> <span class="token number">6</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>quiver<span class="token punctuation">(</span>X<span class="token punctuation">,</span> Y<span class="token punctuation">,</span> U<span class="token punctuation">,</span> V<span class="token punctuation">,</span>
        np<span class="token punctuation">.</span>sqrt<span class="token punctuation">(</span>U<span class="token operator">**</span><span class="token number">2</span> <span class="token operator">+</span> V<span class="token operator">**</span><span class="token number">2</span><span class="token punctuation">)</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 用颜色表示速度大小</span>
        cmap<span class="token operator">=</span><span class="token string">'viridis'</span><span class="token punctuation">,</span>
        angles<span class="token operator">=</span><span class="token string">'xy'</span><span class="token punctuation">,</span>
        scale_units<span class="token operator">=</span><span class="token string">'xy'</span><span class="token punctuation">,</span>
        scale<span class="token operator">=</span><span class="token number">25</span><span class="token punctuation">,</span> <span class="token comment" spellcheck="true"># 调整箭头密度</span>
        width<span class="token operator">=</span><span class="token number">0.003</span><span class="token punctuation">)</span>

    plt<span class="token punctuation">.</span>colorbar<span class="token punctuation">(</span>label<span class="token operator">=</span><span class="token string">'Velocity Magnitude'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>title<span class="token punctuation">(</span>f<span class="token string">'Vector Field at t={t:.2f}'</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>xlim<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>ylim<span class="token punctuation">(</span><span class="token operator">-</span><span class="token number">15</span><span class="token punctuation">,</span> <span class="token number">15</span><span class="token punctuation">)</span>
    plt<span class="token punctuation">.</span>show<span class="token punctuation">(</span><span class="token punctuation">)</span><span aria-hidden="true" class="line-numbers-rows"><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span><span></span></span></code></pre><p>下面放一些作者Notebook中的模型训练得到的向量场, <code>t=0.0</code>:</p><img src="https://cdn.jsdelivr.net/gh/ADAning/Image/MLDL/rectified flow4.png" style="zoom:67%"><p><code>t=0.3</code>:</p><img src="https://cdn.jsdelivr.net/gh/ADAning/Image/MLDL/rectified flow5.png" style="zoom:67%"><p><code>t=0.8</code>:</p><img src="https://cdn.jsdelivr.net/gh/ADAning/Image/MLDL/rectified flow6.png" style="zoom:67%"><blockquote><p>这里留个课后作业, 感兴趣的话还可以画下Notebook里面2-ReFlow的向量场, 应该是个比较直的.</p></blockquote><h2 id="Summary"><a href="#Summary" class="headerlink" title="Summary"></a>Summary</h2><p><strong>Optimal Transport</strong>和Diffusion Model其实有<a href="https://zhuanlan.zhihu.com/p/11439249557" target="_blank" rel="noopener">千丝万缕的联系</a>. Flow-based Model在建模时都是从最优传输视角出发的.</p><p>而Rectified Flow作为Flow-based Generative Model, 通过NN学习一个ODE, 能更快完成生成类任务. 工程实现简单, 受到了大家的青睐, 例如<a href="https://openreview.net/forum?id=FPnUhsQJ5B" target="_blank" rel="noopener">Stable Diffusion 3</a>中就采用了Rectified Flow作为架构. 生成类模型想绕开Rectified Flow几乎是不太可能的. 不得不说, 虽然这些简洁的工作背后隐藏着更深的理论支撑就是了, 但是在大家的眼里总是便于理解, <strong>简单且有效</strong>.</p><p>非常有趣的是, 同期的另一篇工作<a href="https://arxiv.org/abs/2210.02747" target="_blank" rel="noopener">Flow Matching</a>和Rectified Flow思路是一样的, 笔记我写的差不多了, 回头咱们再讲.</p><p>话说回来, 这么一看感觉<a href="https://adaning.github.io/posts/40650.html">DDIM</a>显得像个小丑… 太复杂了, 甚至还不如ReFlow直接用Euler Sampling来的实在.</p><p>当然, 我数学功底不太好, 所以也省略了原文中诸多细节, 尤其是ReFlow的一些性质和推导过程, 我都略过了.</p><p>最后, 需要纠正一个误区. Rectified Flow并非整条粒子的轨迹都是直线. 因为向量场$v$ 肯定不会学的很理想嘛, 所以不可能向量场的每处对$X_1$ 的估计都是准确的, 不可能让向量场的所有处都能使粒子准确的推向$X_1$. 在实际推理采样的时候, 运用欧拉法采样的Step大于1时, 得到的轨迹实际上是<strong>多次折现近似的曲线</strong>, <a href="https://openreview.net/pdf?id=nEDToD1R8M" target="_blank" rel="noopener">这篇ICLR 2025的文章</a>也能佐证这一观点.</p></div><hr><div class="reprint" id="reprint-statement"><div class="reprint__author"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-user">文章作者: </i></span><span class="reprint-info"><a href="/about" rel="external nofollow noreferrer">DaNing</a></span></div><div class="reprint__type"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-link">文章链接: </i></span><span class="reprint-info"><a href="https://ADAning.github.io/posts/24725.html">https://ADAning.github.io/posts/24725.html</a></span></div><div class="reprint__notice"><span class="reprint-meta" style="font-weight:700"><i class="fas fa-copyright">版权声明: </i></span><span class="reprint-info">本博客所有文章除特別声明外，均采用 <a href="https://creativecommons.org/licenses/by/4.0/deed.zh" rel="external nofollow noreferrer" target="_blank">CC BY 4.0</a> 许可协议。转载请注明来源 <a href="/about" target="_blank">DaNing</a> !</span></div></div><script async defer>function navToReprintStatement(){$("html, body").animate({scrollTop:$("#reprint-statement").offset().top-80},800)}document.addEventListener("copy",function(t){M.toast({html:'<span>复制成功，请遵循本文的转载规则</span><button class="btn-flat toast-action" onclick="navToReprintStatement()" style="font-size: smaller">查看</a>'})})</script><div class="tag_share" style="display:block"><div class="post-meta__tag-list" style="display:inline-block"><div class="article-tag"><a href="/tags/Diffusion/"><span class="chip bg-color">Diffusion</span> </a><a href="/tags/Flow/"><span class="chip bg-color">Flow</span> </a><a href="/tags/ReFlow/"><span class="chip bg-color">ReFlow</span></a></div></div><div class="post_share" style="zoom:80%;width:fit-content;display:inline-block;float:right;margin:-.15rem 0"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/share/css/share.min.css"><div id="article-share"><div class="social-share" data-sites="qq,wechat,weibo" data-wechat-qrcode-helper="<p>微信扫一扫即可分享！</p>"></div><script src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/share/js/social-share.min.js"></script></div></div></div></div></div><style>.mvaline-card{margin:1.5rem auto}.mvaline-card .card-content{padding:20px 20px 5px 20px}</style><div class="card mvaline-card" data-aos="fade-up"><div class="comment_headling" style="font-size:20px;font-weight:700;position:relative;padding-left:20px;top:15px;padding-bottom:5px"><i class="fas fa-comments fa-fw" aria-hidden="true"></i> <span>评论</span></div><div id="mvcomments" class="card-content" style="display:grid"></div></div><script src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/minivaline/MiniValine.min.js"></script><script>new MiniValine({el:"#mvcomments",appId:"M2K91TQqrwW698jR08LdugNz-gzGzoHsz",appKey:"b04G08nTf4B3kqCfOOY1urvC",mode:"xCss",placeholder:"评论暂不支持Latex公式, 但支持Markdown语法.",pathname:window.location.pathname,lang:"",adminEmailMd5:"ebbfbc84f11742e41a94a4e64b1d37ab",tagMeta:["管理员","小伙伴","访客"],master:["ebbfbc84f11742e41a94a4e64b1d37ab"],friends:["b5bd5d836c7a0091aa8473e79ed4c25e","adb7d1cd192658a55c0ad22a3309cecf","3ce1e6c77b4910f1871106cb30dc62b0","cfce8dc43725cc14ffcd9fb4892d5bfc"],math:!1,md:!0,enableQQ:!0,NoRecordIP:!1,visitor:!1,maxNest:6,pageSize:12,serverURLs:"",emoticonUrl:["https://cdn.jsdelivr.net/npm/alus@latest","https://cdn.jsdelivr.net/gh/MiniValine/qq@latest","https://cdn.jsdelivr.net/gh/MiniValine/Bilibilis@latest","https://cdn.jsdelivr.net/gh/MiniValine/tieba@latest","https://cdn.jsdelivr.net/gh/MiniValine/twemoji@latest","https://cdn.jsdelivr.net/gh/MiniValine/weibo@latest"]})</script><article id="prenext-posts" class="prev-next articles"><div class="row article-row"><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge left-badge text-color"><i class="fas fa-chevron-left"></i>&nbsp;上一篇</div><div class="card"><a href="/posts/24991.html"><div class="card-image"><img src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/medias/featureimages/8.jpg" class="responsive-img" alt="MeanFlow: Mean Flows for One-step Generative Modeling"> <span class="card-title">MeanFlow: Mean Flows for One-step Generative Modeling</span></div></a><div class="card-content article-content"><div class="summary block-with-text">本文前置知识: Flow Matching: Flow Matching for Generative Modeling. 或者: Rectified Flow: ReFlow: Flow Straight and Fast: Le</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2025-05-22 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" class="post-category">深度学习</a></span></div></div><div class="card-action article-tags"><a href="/tags/Diffusion/"><span class="chip bg-color">Diffusion</span> </a><a href="/tags/Flow/"><span class="chip bg-color">Flow</span> </a><a href="/tags/Flow-Matching/"><span class="chip bg-color">Flow Matching</span> </a><a href="/tags/Mean-Flow/"><span class="chip bg-color">Mean Flow</span></a></div></div></div><div class="article col s12 m6" data-aos="fade-up"><div class="article-badge right-badge text-color">下一篇&nbsp;<i class="fas fa-chevron-right"></i></div><div class="card"><a href="/posts/26761.html"><div class="card-image"><img src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/medias/featureimages/10.jpg" class="responsive-img" alt="AlignSTS: Speech-to-Singing Conversion via Cross-Modal Alignment"> <span class="card-title">AlignSTS: Speech-to-Singing Conversion via Cross-Modal Alignment</span></div></a><div class="card-content article-content"><div class="summary block-with-text">AlignSTS: Speech-to-Singing Conversion via Cross-Modal Alignment 论文: AlignSTS: Speech-to-Singing Conversion via Cross-Mo</div><div class="publish-info"><span class="publish-date"><i class="far fa-clock fa-fw icon-date"></i>2025-05-13 </span><span class="publish-author"><i class="fas fa-bookmark fa-fw icon-category"></i> <a href="/categories/%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0/" class="post-category">深度学习</a></span></div></div><div class="card-action article-tags"><a href="/tags/STS/"><span class="chip bg-color">STS</span> </a><a href="/tags/Audio/"><span class="chip bg-color">Audio</span></a></div></div></div></div></article></div><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/codeBlock/codeBlockFuction.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/codeBlock/codeLang.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/codeBlock/codeCopy.js"></script><script type="text/javascript" src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/codeBlock/codeShrink.js"></script><style type="text/css">code[class*=language-],pre[class*=language-]{white-space:pre!important}</style></div><div id="toc-aside" class="expanded col l3 hide-on-med-and-down"><div class="toc-widget"><div class="toc-title"><i class="far fa-list-alt"></i>&nbsp;&nbsp;目录</div><div id="toc-content"></div></div></div></div><div id="floating-toc-btn" class="hide-on-med-and-down"><a class="btn-floating btn-large bg-color"><i class="fas fa-list-ul"></i></a></div><script src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/tocbot/tocbot.min.js"></script><script>$(function(){tocbot.init({tocSelector:"#toc-content",contentSelector:"#articleContent",headingsOffset:-(.4*$(window).height()-45),collapseDepth:Number("0"),headingSelector:"h2, h3, h4"});let t=0,e="toc-heading-",n=($("#toc-content a").each(function(){$(this).attr("href","#"+e+ ++t)}),t=0,$("#articleContent").children("h2, h3, h4").each(function(){$(this).attr("id",e+ ++t)}),parseInt(.4*$(window).height()-64)),o=$(".toc-widget");$(window).scroll(function(){$(window).scrollTop()>n?o.addClass("toc-fixed"):o.removeClass("toc-fixed")});const i="expanded";let c=$("#toc-aside"),a=$("#main-content");$("#floating-toc-btn .btn-floating").click(function(){c.hasClass(i)?(c.removeClass(i).hide(),a.removeClass("l9")):(c.addClass(i).show(),a.addClass("l9"));{let e=$("#artDetail");if(0!==e.length){let t=e.width();450<=t?t+=21:350<=t&&t<450?t+=18:300<=t&&t<350?t+=16:t+=14,$("#prenext-posts").width(t)}return}})})</script></main><script id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script><script>MathJax={tex:{inlineMath:[["$","$"],["\\(","\\)"]]}}</script><footer class="page-footer bg-color"><div class="container row center-align" style="margin-bottom:0!important"><div class="col s12 m8 l8 copy-right">Copyright&nbsp;&copy; <span id="year">2020</span> <a href="/about" target="_blank">DaNing</a> |&nbsp;Powered by&nbsp;<a href="https://hexo.io/" target="_blank">Hexo</a> |&nbsp;Theme&nbsp;<a href="https://github.com/blinkfox/hexo-theme-matery" target="_blank">Matery</a><br>&nbsp;<i class="fas fa-chart-area"></i>&nbsp;站点总字数:&nbsp;<span class="white-color">430.8k</span>&nbsp;字 <span id="busuanzi_container_site_pv">|&nbsp;<i class="far fa-eye"></i>&nbsp;总访问量:&nbsp;<span id="busuanzi_value_site_pv" class="white-color"></span>&nbsp;次 </span><span id="busuanzi_container_site_uv">|&nbsp;<i class="fas fa-users"></i>&nbsp;总访问人数:&nbsp;<span id="busuanzi_value_site_uv" class="white-color"></span>&nbsp;人</span><br><br></div><div class="col s12 m4 l4 social-link social-statis"><a href="https://github.com/ADAning" class="tooltipped" target="_blank" data-tooltip="访问我的GitHub" data-position="top" data-delay="50"><i class="fab fa-github"></i> </a><a href="mailto:andaning@163.com" class="tooltipped" target="_blank" data-tooltip="邮件联系我" data-position="top" data-delay="50"><i class="fas fa-envelope-open"></i> </a><a href="https://www.zhihu.com/people/nzhu-27" class="tooltipped" target="_blank" data-tooltip="关注我的知乎: https://www.zhihu.com/people/nzhu-27" data-position="top" data-delay="50"><i class="fab fa-zhihu1">知</i></a></div></div></footer><div class="progress-bar"></div><div id="searchModal" class="modal"><div class="modal-content"><div class="search-header"><span class="title"><i class="fas fa-search"></i>&nbsp;&nbsp;搜索</span> <input type="search" id="searchInput" name="s" placeholder="请输入搜索的关键字" class="search-input"></div><div id="searchResult"></div></div></div><script src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/js/search.js"></script><script type="text/javascript">$(function(){searchFunc("https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/search.xml","searchInput","searchResult")})</script><div id="backTop" class="top-scroll"><a class="btn-floating btn-large waves-effect waves-light" href="#!"><i class="fas fa-angle-double-up"></i></a></div><script src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/materialize/materialize.min.js"></script><script src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/masonry/masonry.pkgd.min.js"></script><script src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/aos/aos.js"></script><script src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/scrollprogress/scrollProgress.min.js"></script><script src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/lightGallery/js/lightgallery-all.min.js"></script><script src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/js/matery.js"></script><script>!function(){var t=document.createElement("script"),e=window.location.protocol.split(":")[0];t.src="https"===e?"https://zz.bdstatic.com/linksubmit/push.js":"http://push.zhanzhang.baidu.com/push.js",(e=document.getElementsByTagName("script")[0]).parentNode.insertBefore(t,e)}()</script><script async src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/others/busuanzi.pure.mini.js"></script><script src="https://cdn.jsdelivr.net/gh/ADAning/ADAning.github.io/libs/instantpage/instantpage.js" type="module"></script></body></html>